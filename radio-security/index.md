# 无线电安全

从早期无线电通信技术出现伊始，无线电安全一直是行业所面临的主要问题之一，一战二战中，因为机密无线电信号被窃听、破解，导致情报泄密的事件不胜枚举，随着工业革命的深入，无线电技术早已不再是军事上的专利，它已经深入到了我们生活中的各个角落，日常使用的手机、GPS、WIFI、遥控器、智能硬件、电子支付，出行的汽车、飞机等等，其中都大量的使用了无线电技术，因为使用的普遍性，其所面临的安全状况，也愈加的严峻，近年来频繁出现的伪基站问题、WIFI劫持、无线钓鱼盗号等等，造成了企业或个人大量的财产损失，甚至有可能危害人身安全，尽管无线电通信加密手段越来越多，然而攻击手段也随着进步，无线电攻防在其诞生的一百多年间，以及可预见的将来，都将是一个长久的话题。
 
# BLE 安全
这一段落先简单介绍下蓝牙协议层面的基础知识。
从蓝牙协议来看，协议栈的每个基本构件都分为若干层，提供运行所需的功能。
提供运行所需的功能：

** -应用层**
 与所有其他类型的系统一样，应用程序是最高层，也是 负责逻辑、用户界面和数据处理等一切与实际用例相关的工作。 与应用程序实现的实际用例相关的一切。应用程序的架构
 应用程序的架构在很大程度上取决于每个特定的实现方式。
 
 包括以下各层
 - 通用访问配置文件 (GAP)
 - 通用属性配置文件（GATT）
 - 逻辑链路控制和适配协议 (L2CAP)
 - 属性协议 (ATT)
 - 安全管理器（SM）
 - 主机控制器接口（HCI），主机端

**控制器**
 包括以下各层
- 主机控制器接口 (HCI)，控制器端
 - 链路层 (LL)
 - 物理层（PHY）
![image](https://github.com/user-attachments/assets/bb4f843d-71f3-4c5f-9415-7e8b081be443)

The BLE protocol stack

 **Physical Layer 物理层**
 物理层（PHY）是实际包含模拟通信电路的部分。
 电路，能够对模拟信号进行调制和解调，并将其转换为数字符号。
 数字符号。
 无线电使用 2.4 GHz ISM（工业、科学和医疗）频段进行通信。
无线电使用 2.4 GHz ISM（工业、科学和医疗）频段进行通信，并将该频段划分为从 2.4000 GHz 到 2.4835 GHz 的 40 个信道。下图所示
 如下图所示，其中 37 个信道用于连接数据，最后三个信道（37、38 和 38）用于通信。（37、38 和 39）用作广告信道，用于建立连接和发送广播数据。
![image](https://github.com/user-attachments/assets/fd5ddb07-5910-4c74-b170-b99d9d9af5fe)

该标准使用一种称为跳频扩频的技术，在这种技术中
 在这种技术中，无线电在每次连接事件的信道间跳频使用以下公式：
 channel = (curr_channel + hop) mod 37
 跳频值在连接建立时就已告知，因此每个新建立的连接的跳频值都不同。
因此，每个新建立的连接的跳频值都不同。这种技术最大限度地减少了 2.4 GHz 频段中可能存在的任何无线电干扰的影响。
 特别是由于 WiFi 和传统蓝牙在这一频段中非常普遍，设备可能会在带有蓝牙的设备附近受到严重干扰。
 设备附近可能会受到严重干扰功率。 空中比特流编码所选用的调制方式是高斯频移键控（GFSK）。
 键控（GFSK），与传统蓝牙和其他几种专有低功耗无线协议使用的调制方式相同。
传统蓝牙和其他几种专用低功耗无线协议使用的调制方式相同。低功耗蓝牙的调制速率固定为 1 Mbit/s，而低功耗蓝牙的调制速率固定为 1 Mbit/s。调制速率固定为 1 Mbit/s，这也是该技术的物理吞吐量上限。技术的物理吞吐量上限。

 **链路层**
 链路层是直接与 PHY 接口的部分，通常以定制硬件和软件相结合的方式实现。它通常由定制硬件和软件组合而成。它也是整个协议栈中层，因为它负责遵守协议栈中规定的所有定时要求。 因为它负责遵守规范规定的所有定时要求。因此，它通常通过标准接口将其与协议栈的高层隔离开来
 
 计算昂贵、易于自动化的功能通常由芯片供应商在硬件中实现，以避免运行中央处理单元的 硬件实现，以避免运行堆栈中所有软件层的中央处理单元超载。 堆栈中的所有软件层。
这些功能通常包括
 - 前导码、接入地址和空中协议成帧
 - CRC 生成和验证
 - 数据加白
 - 随机数生成
 - AES 加密
 链路层的软件部分管理无线电的链路状态，也就是设备与其他设备连接的方式。 设备连接其他设备的方式。BLE 设备可以是主设备、从设备或两者兼有、
 这取决于使用情况和要求。发起连接的设备是主设备，发布可用性广告并接受连接的设备是从设备。
 一个主设备可连接多个从设备，一个从设备可连接多个主设备。
 通常情况下，智能手机或平板电脑等设备往往充当主设备，而较小的、简单的和内存受限的设备则充当从设备、
 而更小、更简单、内存受限的设备（如独立传感器）通常扮演从设备的角色。
 蓝牙低功耗技术的底层在主设备和从设备之间存在固有的不对称性。
 低功耗蓝牙在其低层主设备和从设备之间存在固有的不对称性，因为作为主设备需要更多资源。这种不对称性与 USB 相似，USB 主机比 USB 设备需要更多资源。这种架构上的不对称性允许低成本外设运行。

